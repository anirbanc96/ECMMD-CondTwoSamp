cat_dog_after_ECE <- lapply(readRDS("Results/cat_dog_calibrated_ECE.rds"), mean)
cat_deer_asymp_before <- readRDS("Results/cat_deer_asymp_test.rds")
cat_deer_asymp_after <- readRDS("Results/cat_deer_calibrated_asymp_test.rds")
cat_deer_fs_before <- readRDS("Results/cat_deer_finite_sample_test.rds")
cat_deer_fs_after <- readRDS("Results/cat_deer_calibrated_finite_sample_test.rds")
cat_deer_before_ECE <- lapply(readRDS("Results/cat_deer_ECE.rds"), mean)
cat_deer_after_ECE <- lapply(readRDS("Results/cat_deer_calibrated_ECE.rds"), mean)
cat_frog_asymp_before <- readRDS("Results/cat_frog_asymp_test.rds")
cat_frog_asymp_after <- readRDS("Results/cat_frog_calibrated_asymp_test.rds")
cat_frog_fs_before <- readRDS("Results/cat_frog_finite_sample_test.rds")
cat_frog_fs_after <- readRDS("Results/cat_frog_calibrated_finite_sample_test.rds")
cat_frog_before_ECE <- lapply(readRDS("Results/cat_frog_ECE.rds"), mean)
cat_frog_after_ECE <- lapply(readRDS("Results/cat_frog_calibrated_ECE.rds"), mean)
cat_horse_asymp_before <- readRDS("Results/cat_horse_asymp_test.rds")
cat_horse_asymp_after <- readRDS("Results/cat_horse_calibrated_asymp_test.rds")
cat_horse_fs_before <- readRDS("Results/cat_horse_finite_sample_test.rds")
cat_horse_fs_after <- readRDS("Results/cat_horse_calibrated_finite_sample_test.rds")
cat_horse_before_ECE <- lapply(readRDS("Results/cat_horse_ECE.rds"), mean)
cat_horse_after_ECE <- lapply(readRDS("Results/cat_horse_calibrated_ECE.rds"), mean)
cat_dog_after_ECE
for (j in 1:ncol(name_mat)){
class_a <- name_mat[1, j]
class_b <- name_mat[2, j]
prop_before_asymp <- paste(class_a, "_", class_b, "_before_rej_asymp")
prop_before_fs <- paste(class_a, "_", class_b, "_before_rej_fs")
prop_after_asymp <- paste(class_a, "_", class_b, "_after_rej_asymp")
prop_after_fs <- paste(class_a, "_", class_b, "_after_rej_fs")
result <- data.frame(c("FS", "FS", "FS", "FS", "Asymp", "Asymp", "Asymp", "Asymp", "ECE"),
rep(seq(k_1-1, k_2-1, by_knn),2),
)
}
for (j in 1:ncol(name_mat)){
class_a <- name_mat[1, j]
class_b <- name_mat[2, j]
prop_before_asymp <- paste(class_a, "_", class_b, "_before_rej_asymp")
prop_before_fs <- paste(class_a, "_", class_b, "_before_rej_fs")
prop_after_asymp <- paste(class_a, "_", class_b, "_after_rej_asymp")
prop_after_fs <- paste(class_a, "_", class_b, "_after_rej_fs")
result <- data.frame(c("FS", "FS", "FS", "FS", "Asymp", "Asymp", "Asymp", "Asymp", "ECE"),
rep(seq(k_1-1, k_2-1, by_knn),2))
}
for (j in 1:ncol(name_mat)){
class_a <- name_mat[1, j]
class_b <- name_mat[2, j]
prop_before_asymp <- paste(class_a, "_", class_b, "_before_rej_asymp")
prop_before_fs <- paste(class_a, "_", class_b, "_before_rej_fs")
prop_after_asymp <- paste(class_a, "_", class_b, "_after_rej_asymp")
prop_after_fs <- paste(class_a, "_", class_b, "_after_rej_fs")
result <- data.frame(c("FS", "FS", "FS", "FS", "Asymp", "Asymp", "Asymp", "Asymp", "ECE"),
c(rep(seq(k_1-1, k_2-1, by_knn),2), ""))
}
result
for (j in 1:ncol(name_mat)){
class_a <- name_mat[1, j]
class_b <- name_mat[2, j]
prop_before_asymp <- paste(class_a, "_", class_b, "_before_rej_asymp")
prop_before_fs <- paste(class_a, "_", class_b, "_before_rej_fs")
prop_after_asymp <- paste(class_a, "_", class_b, "_after_rej_asymp")
prop_after_fs <- paste(class_a, "_", class_b, "_after_rej_fs")
result <- data.frame(c("FS", "FS", "FS", "FS", "Asymp", "Asymp", "Asymp", "Asymp", "ECE"),
c(rep(seq(k_1-1, k_2-1, by_knn),2), ""),
rbind(prop_before_fs, prop_before_asymp))
}
sapply(cat_dog_after_ECE, mean)
as.vector(cat_dog_after_ECE)
mean(sapply(cat_deer_after_ECE, function(x){x[1]}))
for (j in 1:ncol(name_mat)){
class_a <- name_mat[1, j]
class_b <- name_mat[2, j]
prop_before_asymp <- paste(class_a, "_", class_b, "_before_rej_asymp")
prop_before_fs <- paste(class_a, "_", class_b, "_before_rej_fs")
prop_after_asymp <- paste(class_a, "_", class_b, "_after_rej_asymp")
prop_after_fs <- paste(class_a, "_", class_b, "_after_rej_fs")
ECE_before <- mean(sapply(paste(class_a,"_",class_b,"_before_ECE"), function(x){x[1]}))
ECE_after <- mean(sapply(paste(class_a,"_",class_b,"_after_ECE"), function(x){x[1]}))
result <- data.frame(c("FS", "FS", "FS", "FS", "Asymp", "Asymp", "Asymp", "Asymp", "ECE"),
c(rep(seq(k_1-1, k_2-1, by_knn),2), ""),
rbind(prop_before_fs/length(seed_list), prop_before_asymp/length(seed_list), ECE_before))
}
prop_after_asymp
for (j in 1:ncol(name_mat)){
class_a <- name_mat[1, j]
class_b <- name_mat[2, j]
ECE <- readRDS(sprintf("Results/%s_%s_ECE.rds", class_a, class_b))
f_test <- readRDS(sprintf("Results/%s_%s_finite_sample_test.rds", class_a, class_b))
asymp_test <- readRDS(sprintf("Results/%s_%s_asymp_test.rds",
class_a, class_b))
ECE_calibrated <- readRDS(sprintf("Results/%s_%s_calibrated_ECE.rds",
class_a, class_b))
f_calibrated_test <- readRDS(sprintf("Results/%s_%s_calibrated_finite_sample_test.rds",
class_a, class_b))
asymp_calibrated_test <- readRDS(
sprintf("results/%s_%s_calibrated_asymp_test.rds",
class_a, class_b))
before_asymp <- rep(0, num_knn)
after_asymp <- rep(0, num_knn)
before_fs <- rep(0, num_knn)
after_fs <- rep(0, num_knn)
ECE_before <- 0
ECE_after <- 0
for (i in 1:length(seed_list)){
before_asymp <- before_asymp + (asymp_test[[i]] <= 0.05)/length(seed_list)
before_fs <- before_fs + (f_test[[i]] <= 0.05)/length(seed_list)
after_asymp <- after_asymp + (asymp_calibrated_test[[i]] <= 0.05)/length(seed_list)
after_fs <- after_fs + (f_calibrated_test[[i]] <= 0.05)/length(seed_list)
ECE_before <- ECE_before + ECE[[i]]/length(seed_list)
ECE_after <- ECE_after + ECE_calibrated[[i]]/length(seed_list)
}
result <- data.frame(c("FS", "FS", "FS", "FS", "Asymp", "Asymp", "Asymp", "Asymp", "ECE"),
c(rep(seq(k_1-1, k_2-1, by_knn),2), ""),
c(before_fs, before_asymp, ECE_before),
c(after_fs, after_asymp, ECE_after))
}
result
for (j in 1:ncol(name_mat)){
class_a <- name_mat[1, j]
class_b <- name_mat[2, j]
ECE <- readRDS(sprintf("Results/%s_%s_ECE.rds", class_a, class_b))
f_test <- readRDS(sprintf("Results/%s_%s_finite_sample_test.rds", class_a, class_b))
asymp_test <- readRDS(sprintf("Results/%s_%s_asymp_test.rds",
class_a, class_b))
ECE_calibrated <- readRDS(sprintf("Results/%s_%s_calibrated_ECE.rds",
class_a, class_b))
f_calibrated_test <- readRDS(sprintf("Results/%s_%s_calibrated_finite_sample_test.rds",
class_a, class_b))
asymp_calibrated_test <- readRDS(
sprintf("results/%s_%s_calibrated_asymp_test.rds",
class_a, class_b))
before_asymp <- rep(0, num_knn)
after_asymp <- rep(0, num_knn)
before_fs <- rep(0, num_knn)
after_fs <- rep(0, num_knn)
ECE_before <- 0
ECE_after <- 0
for (i in 1:length(seed_list)){
before_asymp <- before_asymp + (asymp_test[[i]] <= 0.05)/length(seed_list)
before_fs <- before_fs + (f_test[[i]] <= 0.05)/length(seed_list)
after_asymp <- after_asymp + (asymp_calibrated_test[[i]] <= 0.05)/length(seed_list)
after_fs <- after_fs + (f_calibrated_test[[i]] <= 0.05)/length(seed_list)
ECE_before <- ECE_before + ECE[[i]]/length(seed_list)
ECE_after <- ECE_after + ECE_calibrated[[i]]/length(seed_list)
}
result <- data.frame(c("FS", "FS", "FS", "FS", "Asymp", "Asymp", "Asymp", "Asymp", "ECE"),
c(rep(seq(k_1-1, k_2-1, by_knn),2), ""),
sapply(c(before_fs, before_asymp, ECE_before), round, 3),
sapply(c(after_fs, after_asymp, ECE_after), round, 3))
}
result
for (j in 1:ncol(name_mat)){
class_a <- name_mat[1, j]
class_b <- name_mat[2, j]
ECE <- readRDS(sprintf("Results/%s_%s_ECE.rds", class_a, class_b))
f_test <- readRDS(sprintf("Results/%s_%s_finite_sample_test.rds", class_a, class_b))
asymp_test <- readRDS(sprintf("Results/%s_%s_asymp_test.rds",
class_a, class_b))
ECE_calibrated <- readRDS(sprintf("Results/%s_%s_calibrated_ECE.rds",
class_a, class_b))
f_calibrated_test <- readRDS(sprintf("Results/%s_%s_calibrated_finite_sample_test.rds",
class_a, class_b))
asymp_calibrated_test <- readRDS(
sprintf("results/%s_%s_calibrated_asymp_test.rds",
class_a, class_b))
before_asymp <- rep(0, num_knn)
after_asymp <- rep(0, num_knn)
before_fs <- rep(0, num_knn)
after_fs <- rep(0, num_knn)
ECE_before <- 0
ECE_after <- 0
for (i in 1:length(seed_list)){
before_asymp <- before_asymp + (asymp_test[[i]] <= 0.05)/length(seed_list)
before_fs <- before_fs + (f_test[[i]] <= 0.05)/length(seed_list)
after_asymp <- after_asymp + (asymp_calibrated_test[[i]] <= 0.05)/length(seed_list)
after_fs <- after_fs + (f_calibrated_test[[i]] <= 0.05)/length(seed_list)
ECE_before <- ECE_before + ECE[[i]]/length(seed_list)
ECE_after <- ECE_after + ECE_calibrated[[i]]/length(seed_list)
}
result <- data.frame(c("FS", "FS", "FS", "FS", "Asymp", "Asymp", "Asymp", "Asymp", "ECE"),
c(rep(seq(k_1-1, k_2-1, by_knn),2), ""),
sapply(c(before_fs, before_asymp, ECE_before), round, 2),
sapply(c(after_fs, after_asymp, ECE_after), round, 2))
kable_output <- kable(results, "latex", booktabs = T, escape = FALSE, align = c('c', 'c', 'c', 'c')) %>%
kable_styling(latex_options = c("striped", "hold_position")) %>%
row_spec(nrow(results)) %>%
add_header_above(c(" " = 1, " " = 1, "P-values" = 2))
writeLines(kable_output, sprintf("Figures/%s_%s_result.tex",
class_a, class_b))
}
library(knitr)
library(kableExtra)
for (j in 1:ncol(name_mat)){
class_a <- name_mat[1, j]
class_b <- name_mat[2, j]
ECE <- readRDS(sprintf("Results/%s_%s_ECE.rds", class_a, class_b))
f_test <- readRDS(sprintf("Results/%s_%s_finite_sample_test.rds", class_a, class_b))
asymp_test <- readRDS(sprintf("Results/%s_%s_asymp_test.rds",
class_a, class_b))
ECE_calibrated <- readRDS(sprintf("Results/%s_%s_calibrated_ECE.rds",
class_a, class_b))
f_calibrated_test <- readRDS(sprintf("Results/%s_%s_calibrated_finite_sample_test.rds",
class_a, class_b))
asymp_calibrated_test <- readRDS(
sprintf("results/%s_%s_calibrated_asymp_test.rds",
class_a, class_b))
before_asymp <- rep(0, num_knn)
after_asymp <- rep(0, num_knn)
before_fs <- rep(0, num_knn)
after_fs <- rep(0, num_knn)
ECE_before <- 0
ECE_after <- 0
for (i in 1:length(seed_list)){
before_asymp <- before_asymp + (asymp_test[[i]] <= 0.05)/length(seed_list)
before_fs <- before_fs + (f_test[[i]] <= 0.05)/length(seed_list)
after_asymp <- after_asymp + (asymp_calibrated_test[[i]] <= 0.05)/length(seed_list)
after_fs <- after_fs + (f_calibrated_test[[i]] <= 0.05)/length(seed_list)
ECE_before <- ECE_before + ECE[[i]]/length(seed_list)
ECE_after <- ECE_after + ECE_calibrated[[i]]/length(seed_list)
}
result <- data.frame(c("FS", "FS", "FS", "FS", "Asymp", "Asymp", "Asymp", "Asymp", "ECE"),
c(rep(seq(k_1-1, k_2-1, by_knn),2), ""),
sapply(c(before_fs, before_asymp, ECE_before), round, 2),
sapply(c(after_fs, after_asymp, ECE_after), round, 2))
kable_output <- kable(results, "latex", booktabs = T, escape = FALSE, align = c('c', 'c', 'c', 'c')) %>%
kable_styling(latex_options = c("striped", "hold_position")) %>%
row_spec(nrow(results)) %>%
add_header_above(c(" " = 1, " " = 1, "P-values" = 2))
writeLines(kable_output, sprintf("Figures/%s_%s_result.tex",
class_a, class_b))
}
for (j in 1:ncol(name_mat)){
class_a <- name_mat[1, j]
class_b <- name_mat[2, j]
ECE <- readRDS(sprintf("Results/%s_%s_ECE.rds", class_a, class_b))
f_test <- readRDS(sprintf("Results/%s_%s_finite_sample_test.rds", class_a, class_b))
asymp_test <- readRDS(sprintf("Results/%s_%s_asymp_test.rds",
class_a, class_b))
ECE_calibrated <- readRDS(sprintf("Results/%s_%s_calibrated_ECE.rds",
class_a, class_b))
f_calibrated_test <- readRDS(sprintf("Results/%s_%s_calibrated_finite_sample_test.rds",
class_a, class_b))
asymp_calibrated_test <- readRDS(
sprintf("results/%s_%s_calibrated_asymp_test.rds",
class_a, class_b))
before_asymp <- rep(0, num_knn)
after_asymp <- rep(0, num_knn)
before_fs <- rep(0, num_knn)
after_fs <- rep(0, num_knn)
ECE_before <- 0
ECE_after <- 0
for (i in 1:length(seed_list)){
before_asymp <- before_asymp + (asymp_test[[i]] <= 0.05)/length(seed_list)
before_fs <- before_fs + (f_test[[i]] <= 0.05)/length(seed_list)
after_asymp <- after_asymp + (asymp_calibrated_test[[i]] <= 0.05)/length(seed_list)
after_fs <- after_fs + (f_calibrated_test[[i]] <= 0.05)/length(seed_list)
ECE_before <- ECE_before + ECE[[i]]/length(seed_list)
ECE_after <- ECE_after + ECE_calibrated[[i]]/length(seed_list)
}
result <- data.frame(c("FS", "FS", "FS", "FS", "Asymp", "Asymp", "Asymp", "Asymp", "ECE"),
c(rep(seq(k_1-1, k_2-1, by_knn),2), ""),
sapply(c(before_fs, before_asymp, ECE_before), round, 2),
sapply(c(after_fs, after_asymp, ECE_after), round, 2))
kable_output <- kable(result, "latex", booktabs = T, escape = FALSE, align = c('c', 'c', 'c', 'c')) %>%
kable_styling(latex_options = c("striped", "hold_position")) %>%
row_spec(nrow(results)) %>%
add_header_above(c(" " = 1, " " = 1, "P-values" = 2))
writeLines(kable_output, sprintf("Figures/%s_%s_result.tex",
class_a, class_b))
}
for (j in 1:ncol(name_mat)){
class_a <- name_mat[1, j]
class_b <- name_mat[2, j]
ECE <- readRDS(sprintf("Results/%s_%s_ECE.rds", class_a, class_b))
f_test <- readRDS(sprintf("Results/%s_%s_finite_sample_test.rds", class_a, class_b))
asymp_test <- readRDS(sprintf("Results/%s_%s_asymp_test.rds",
class_a, class_b))
ECE_calibrated <- readRDS(sprintf("Results/%s_%s_calibrated_ECE.rds",
class_a, class_b))
f_calibrated_test <- readRDS(sprintf("Results/%s_%s_calibrated_finite_sample_test.rds",
class_a, class_b))
asymp_calibrated_test <- readRDS(
sprintf("results/%s_%s_calibrated_asymp_test.rds",
class_a, class_b))
before_asymp <- rep(0, num_knn)
after_asymp <- rep(0, num_knn)
before_fs <- rep(0, num_knn)
after_fs <- rep(0, num_knn)
ECE_before <- 0
ECE_after <- 0
for (i in 1:length(seed_list)){
before_asymp <- before_asymp + (asymp_test[[i]] <= 0.05)/length(seed_list)
before_fs <- before_fs + (f_test[[i]] <= 0.05)/length(seed_list)
after_asymp <- after_asymp + (asymp_calibrated_test[[i]] <= 0.05)/length(seed_list)
after_fs <- after_fs + (f_calibrated_test[[i]] <= 0.05)/length(seed_list)
ECE_before <- ECE_before + ECE[[i]]/length(seed_list)
ECE_after <- ECE_after + ECE_calibrated[[i]]/length(seed_list)
}
result <- data.frame(c("FS", "FS", "FS", "FS", "Asymp", "Asymp", "Asymp", "Asymp", "ECE"),
c(rep(seq(k_1-1, k_2-1, by_knn),2), ""),
sapply(c(before_fs, before_asymp, ECE_before), round, 2),
sapply(c(after_fs, after_asymp, ECE_after), round, 2))
kable_output <- kable(result, "latex", booktabs = T, escape = FALSE, align = c('c', 'c', 'c', 'c')) %>%
kable_styling(latex_options = c("striped", "hold_position")) %>%
row_spec(nrow(result)) %>%
add_header_above(c(" " = 1, " " = 1, "P-values" = 2))
writeLines(kable_output, sprintf("Figures/%s_%s_result.tex",
class_a, class_b))
}
for (j in 1:ncol(name_mat)){
class_a <- name_mat[1, j]
class_b <- name_mat[2, j]
ECE <- readRDS(sprintf("Results/%s_%s_ECE.rds", class_a, class_b))
f_test <- readRDS(sprintf("Results/%s_%s_finite_sample_test.rds", class_a, class_b))
asymp_test <- readRDS(sprintf("Results/%s_%s_asymp_test.rds",
class_a, class_b))
ECE_calibrated <- readRDS(sprintf("Results/%s_%s_calibrated_ECE.rds",
class_a, class_b))
f_calibrated_test <- readRDS(sprintf("Results/%s_%s_calibrated_finite_sample_test.rds",
class_a, class_b))
asymp_calibrated_test <- readRDS(
sprintf("results/%s_%s_calibrated_asymp_test.rds",
class_a, class_b))
before_asymp <- rep(0, num_knn)
after_asymp <- rep(0, num_knn)
before_fs <- rep(0, num_knn)
after_fs <- rep(0, num_knn)
ECE_before <- 0
ECE_after <- 0
for (i in 1:length(seed_list)){
before_asymp <- before_asymp + (asymp_test[[i]] <= 0.05)/length(seed_list)
before_fs <- before_fs + (f_test[[i]] <= 0.05)/length(seed_list)
after_asymp <- after_asymp + (asymp_calibrated_test[[i]] <= 0.05)/length(seed_list)
after_fs <- after_fs + (f_calibrated_test[[i]] <= 0.05)/length(seed_list)
ECE_before <- ECE_before + ECE[[i]]/length(seed_list)
ECE_after <- ECE_after + ECE_calibrated[[i]]/length(seed_list)
}
result <- data.frame(Test = c("FS", "FS", "FS", "FS", "Asymp", "Asymp", "Asymp", "Asymp", "ECE"),
K = c(rep(seq(k_1-1, k_2-1, by_knn),2), ""),
Before = sapply(c(before_fs, before_asymp, ECE_before), round, 2),
After = sapply(c(after_fs, after_asymp, ECE_after), round, 2))
kable_output <- kable(result, "latex", booktabs = T, escape = FALSE, align = c('c', 'c', 'c', 'c')) %>%
kable_styling(latex_options = c("striped", "hold_position")) %>%
row_spec(nrow(result)) %>%
add_header_above(c(" " = 1, " " = 1, "P-values" = 2))
writeLines(kable_output, sprintf("Figures/%s_%s_result.tex",
class_a, class_b))
}
for (j in 1:ncol(name_mat)){
class_a <- name_mat[1, j]
class_b <- name_mat[2, j]
ECE <- readRDS(sprintf("Results/%s_%s_ECE.rds", class_a, class_b))
f_test <- readRDS(sprintf("Results/%s_%s_finite_sample_test.rds", class_a, class_b))
asymp_test <- readRDS(sprintf("Results/%s_%s_asymp_test.rds",
class_a, class_b))
ECE_calibrated <- readRDS(sprintf("Results/%s_%s_calibrated_ECE.rds",
class_a, class_b))
f_calibrated_test <- readRDS(sprintf("Results/%s_%s_calibrated_finite_sample_test.rds",
class_a, class_b))
asymp_calibrated_test <- readRDS(
sprintf("results/%s_%s_calibrated_asymp_test.rds",
class_a, class_b))
before_asymp <- rep(0, num_knn)
after_asymp <- rep(0, num_knn)
before_fs <- rep(0, num_knn)
after_fs <- rep(0, num_knn)
ECE_before <- 0
ECE_after <- 0
for (i in 1:length(seed_list)){
before_asymp <- before_asymp + (asymp_test[[i]] <= 0.05)/length(seed_list)
before_fs <- before_fs + (f_test[[i]] <= 0.05)/length(seed_list)
after_asymp <- after_asymp + (asymp_calibrated_test[[i]] <= 0.05)/length(seed_list)
after_fs <- after_fs + (f_calibrated_test[[i]] <= 0.05)/length(seed_list)
ECE_before <- ECE_before + ECE[[i]]/length(seed_list)
ECE_after <- ECE_after + ECE_calibrated[[i]]/length(seed_list)
}
result <- data.frame(Test = c("FS", "FS", "FS", "FS", "Asymp", "Asymp", "Asymp", "Asymp", "ECE"),
K = c(rep(seq(k_1-1, k_2-1, by_knn),2), ""),
Before = sapply(c(before_fs, before_asymp, ECE_before), round, 2),
After = sapply(c(after_fs, after_asymp, ECE_after), round, 2))
kable_output <- kable(result, "latex", booktabs = T, escape = FALSE, align = c('c', 'c', 'c', 'c')) %>%
kable_styling(latex_options = c("striped", "hold_position")) %>%
row_spec(nrow(result)) %>%
add_header_above(c(" " = 1, " " = 1, "Rejection Proportion" = 2))
writeLines(kable_output, sprintf("Figures/%s_%s_result.tex",
class_a, class_b))
print (result)
}
ECE
2*ECE
for (j in 1:ncol(name_mat)){
class_a <- name_mat[1, j]
class_b <- name_mat[2, j]
ECE <- lapply(readRDS(sprintf("Results/%s_%s_ECE.rds", class_a, class_b)), function(x){2*x})
f_test <- readRDS(sprintf("Results/%s_%s_finite_sample_test.rds", class_a, class_b))
asymp_test <- readRDS(sprintf("Results/%s_%s_asymp_test.rds",
class_a, class_b))
ECE_calibrated <- readRDS(sprintf("Results/%s_%s_calibrated_ECE.rds",
class_a, class_b))
f_calibrated_test <- readRDS(sprintf("Results/%s_%s_calibrated_finite_sample_test.rds",
class_a, class_b))
asymp_calibrated_test <- readRDS(
sprintf("results/%s_%s_calibrated_asymp_test.rds",
class_a, class_b))
before_asymp <- rep(0, num_knn)
after_asymp <- rep(0, num_knn)
before_fs <- rep(0, num_knn)
after_fs <- rep(0, num_knn)
ECE_before <- 0
ECE_after <- 0
for (i in 1:length(seed_list)){
before_asymp <- before_asymp + (asymp_test[[i]] <= 0.05)/length(seed_list)
before_fs <- before_fs + (f_test[[i]] <= 0.05)/length(seed_list)
after_asymp <- after_asymp + (asymp_calibrated_test[[i]] <= 0.05)/length(seed_list)
after_fs <- after_fs + (f_calibrated_test[[i]] <= 0.05)/length(seed_list)
ECE_before <- ECE_before + ECE[[i]]/length(seed_list)
ECE_after <- ECE_after + ECE_calibrated[[i]]/length(seed_list)
}
result <- data.frame(Test = c("FS", "FS", "FS", "FS", "Asymp", "Asymp", "Asymp", "Asymp", "ECE"),
K = c(rep(seq(k_1-1, k_2-1, by_knn),2), ""),
Before = sapply(c(before_fs, before_asymp, ECE_before), round, 2),
After = sapply(c(after_fs, after_asymp, ECE_after), round, 2))
kable_output <- kable(result, "latex", booktabs = T, escape = FALSE, align = c('c', 'c', 'c', 'c')) %>%
kable_styling(latex_options = c("striped", "hold_position")) %>%
row_spec(nrow(result)) %>%
add_header_above(c(" " = 1, " " = 1, "Rejection Proportion" = 2))
writeLines(kable_output, sprintf("Figures/%s_%s_result.tex",
class_a, class_b))
print (result)
}
ECE
for (j in 1:ncol(name_mat)){
class_a <- name_mat[1, j]
class_b <- name_mat[2, j]
ECE <- lapply(readRDS(sprintf("Results/%s_%s_ECE.rds", class_a, class_b)), function(x){2*x})
saveRDS(ECE,
file = sprintf("Results/%s_%s_ECE.rds",
class_a,
class_b))
f_test <- readRDS(sprintf("Results/%s_%s_finite_sample_test.rds", class_a, class_b))
asymp_test <- readRDS(sprintf("Results/%s_%s_asymp_test.rds",
class_a, class_b))
ECE_calibrated <- readRDS(sprintf("Results/%s_%s_calibrated_ECE.rds",
class_a, class_b))
f_calibrated_test <- readRDS(sprintf("Results/%s_%s_calibrated_finite_sample_test.rds",
class_a, class_b))
asymp_calibrated_test <- readRDS(
sprintf("results/%s_%s_calibrated_asymp_test.rds",
class_a, class_b))
before_asymp <- rep(0, num_knn)
after_asymp <- rep(0, num_knn)
before_fs <- rep(0, num_knn)
after_fs <- rep(0, num_knn)
ECE_before <- 0
ECE_after <- 0
for (i in 1:length(seed_list)){
before_asymp <- before_asymp + (asymp_test[[i]] <= 0.05)/length(seed_list)
before_fs <- before_fs + (f_test[[i]] <= 0.05)/length(seed_list)
after_asymp <- after_asymp + (asymp_calibrated_test[[i]] <= 0.05)/length(seed_list)
after_fs <- after_fs + (f_calibrated_test[[i]] <= 0.05)/length(seed_list)
ECE_before <- ECE_before + ECE[[i]]/length(seed_list)
ECE_after <- ECE_after + ECE_calibrated[[i]]/length(seed_list)
}
result <- data.frame(Test = c("FS", "FS", "FS", "FS", "Asymp", "Asymp", "Asymp", "Asymp", "ECE"),
K = c(rep(seq(k_1-1, k_2-1, by_knn),2), ""),
Before = sapply(c(before_fs, before_asymp, ECE_before), round, 2),
After = sapply(c(after_fs, after_asymp, ECE_after), round, 2))
kable_output <- kable(result, "latex", booktabs = T, escape = FALSE, align = c('c', 'c', 'c', 'c')) %>%
kable_styling(latex_options = c("striped", "hold_position")) %>%
row_spec(nrow(result)) %>%
add_header_above(c(" " = 1, " " = 1, "Rejection Proportion" = 2))
writeLines(kable_output, sprintf("Figures/%s_%s_result.tex",
class_a, class_b))
print (result)
}
for (j in 1:ncol(name_mat)){
class_a <- name_mat[1, j]
class_b <- name_mat[2, j]
ECE <- readRDS(sprintf("Results/%s_%s_ECE.rds", class_a, class_b))
f_test <- readRDS(sprintf("Results/%s_%s_finite_sample_test.rds", class_a, class_b))
asymp_test <- readRDS(sprintf("Results/%s_%s_asymp_test.rds",
class_a, class_b))
ECE_calibrated <- readRDS(sprintf("Results/%s_%s_calibrated_ECE.rds",
class_a, class_b))
f_calibrated_test <- readRDS(sprintf("Results/%s_%s_calibrated_finite_sample_test.rds",
class_a, class_b))
asymp_calibrated_test <- readRDS(
sprintf("results/%s_%s_calibrated_asymp_test.rds",
class_a, class_b))
before_asymp <- rep(0, num_knn)
after_asymp <- rep(0, num_knn)
before_fs <- rep(0, num_knn)
after_fs <- rep(0, num_knn)
ECE_before <- 0
ECE_after <- 0
for (i in 1:length(seed_list)){
before_asymp <- before_asymp + (asymp_test[[i]] <= 0.05)/length(seed_list)
before_fs <- before_fs + (f_test[[i]] <= 0.05)/length(seed_list)
after_asymp <- after_asymp + (asymp_calibrated_test[[i]] <= 0.05)/length(seed_list)
after_fs <- after_fs + (f_calibrated_test[[i]] <= 0.05)/length(seed_list)
ECE_before <- ECE_before + ECE[[i]]/length(seed_list)
ECE_after <- ECE_after + ECE_calibrated[[i]]/length(seed_list)
}
result <- data.frame(Test = c("FS", "FS", "FS", "FS", "Asymp", "Asymp", "Asymp", "Asymp", "ECE"),
K = c(rep(seq(k_1-1, k_2-1, by_knn),2), ""),
Before = sapply(c(before_fs, before_asymp, ECE_before), round, 2),
After = sapply(c(after_fs, after_asymp, ECE_after), round, 2))
kable_output <- kable(result, "latex", booktabs = T, escape = FALSE, align = c('c', 'c', 'c', 'c')) %>%
kable_styling(latex_options = c("striped", "hold_position")) %>%
row_spec(nrow(result)) %>%
add_header_above(c(" " = 1, " " = 1, "Rejection Proportion" = 2))
writeLines(kable_output, sprintf("Figures/%s_%s_result.tex",
class_a, class_b))
print (result)
}
